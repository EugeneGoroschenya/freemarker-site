<!doctype html>
<html lang="en" class="page-type-section">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<title>2.3.24 Preview 1 - FreeMarker Manual</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="format-detection" content="telephone=no">
<meta property="og:site_name" content="FreeMarker Manual">
<meta property="og:title" content="2.3.24 Preview 1">
<meta property="og:locale" content="en_US">
<meta property="og:url" content="http://freemarker.org/docs/versions_2_3_24.html">
<link rel="canoical" href="http://freemarker.org/docs/versions_2_3_24.html">
<link rel="icon" href="favicon.png" type="image/png">
<link rel="stylesheet" type="text/css" href="docgen-resources/docgen.min.css">
</head>
<body itemscope itemtype="https://schema.org/Code">
    <meta itemprop="version" content="2.3.23">
    <meta itemprop="url" content="http://freemarker.org/docs/">
    <meta itemprop="name" content="FreeMarker Manual">

  <!--[if lte IE 9]>
  <div style="background-color: #C00; color: #fff; padding: 12px 24px;">Please use a modern browser to view this website.</div>
  <![endif]--><div class="header-top-bg"><div class="site-width header-top"><a class="logo" href="http://freemarker.org" role="banner">            <img itemprop="image" src="logo.png" alt="FreeMarker">
</a><ul class="tabs"><li><a href="http://freemarker.org/">Home</a></li><li class="current"><a href="index.html">Manual</a></li><li><a class="external" href="api/index.html">Java API</a></li></ul><ul class="secondary-tabs"><li><a class="tab icon-heart" href="http://freemarker.org/contribute.html" title="Contribute"><span>Contribute</span></a></li><li><a class="tab icon-bug" href="https://sourceforge.net/p/freemarker/bugs/new/" title="Report a Bug"><span>Report a Bug</span></a></li><li><a class="tab icon-download" href="http://freemarker.org/freemarkerdownload.html" title="Download"><span>Download</span></a></li></ul></div></div><div class="header-bottom-bg"><div class="site-width search-row"><a href="toc.html" class="navigation-header">Manual</a><div class="navigation-header"></div></div><div class="site-width breadcrumb-row"><ul class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList"><li class="step-0" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a class="label" itemprop="item" href="toc.html"><span itemprop="name">FreeMarker Manual</span></a></li><li class="step-1" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a class="label" itemprop="item" href="app.html"><span itemprop="name">Appendixes</span></a></li><li class="step-2" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a class="label" itemprop="item" href="app_versions.html"><span itemprop="name">Version history</span></a></li><li class="step-3" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a class="label" itemprop="item" href="versions_2_3_24.html"><span itemprop="name">2.3.24 Preview 1</span></a></li></ul><div class="bookmarks" title="Bookmarks"><span class="sr-only">Bookmarks:</span><ul class="bookmark-list"><li><a href="alphaidx.html">Alpha. index</a></li><li><a href="gloss.html">Glossary</a></li><li><a href="dgui_template_exp.html#exp_cheatsheet">Expressions</a></li><li><a href="ref_builtins_alphaidx.html">?builtins</a></li><li><a href="ref_directive_alphaidx.html">#directives</a></li><li><a href="ref_specvar.html">.spec_vars</a></li><li><a href="app_faq.html">FAQ</a></li></ul></div></div></div>    <div class="main-content site-width">
      <div class="content-wrapper">
  <div id="table-of-contents-wrapper" class="col-left">
      <script>var breadcrumb = ["FreeMarker Manual","Appendixes","Version history","2.3.24 Preview 1"];</script>
      <script src="toc.js"></script>
      <script src="docgen-resources/main.min.js"></script>
  </div>
<div class="col-right"><div class="page-content"><div class="page-title"><div class="pagers top"><a class="paging-arrow previous" href="app_versions.html"><span>Previous</span></a><a class="paging-arrow next" href="versions_2_3_23.html"><span>Next</span></a></div><div class="title-wrapper">
<h1 class="content-header header-section1" id="versions_2_3_24" itemprop="headline">2.3.24 Preview 1</h1>
</div></div><div class="page-menu">
<div class="page-menu-title">Page Contents</div>
<ul><li><a class="page-menu-link" href="#autoid_153" data-menu-target="autoid_153">Changes on the FTL side</a></li><li><a class="page-menu-link" href="#autoid_154" data-menu-target="autoid_154">Changes on the Java side</a></li></ul> </div><p>Date of release: 2015-09-01 for preview release 1</p><p>Date of release for final is not yet known (end of
        October?).</p><p>Please test for backward compatibility, and help polishing the
        new features!</p>
          



<h2 class="content-header header-section2" id="autoid_153">Changes on the FTL side</h2>


          <ul>
            <li>
              <p>The most important new feature of this release is the
              <a href="dgui_misc_autoescaping.html">auto-escaping and output
              formats mechanism</a>, which deprecates escaping with the
              <a href="ref_directive_escape.html"><code>escape</code>
              directive</a>. These are the items related to this new
              mechanism (see <a href="dgui_misc_autoescaping.html">early
              linked section</a> for a guide):</p>

              <ul>
                <li>
                  <p>New <code class="inline-code">ftl</code> header options,
                  <code class="inline-code">ouput_format</code> and
                  <code class="inline-code">auto_esc</code> to override the
                  <code class="inline-code">output_format</code> and
                  <code class="inline-code">auto_escaping</code> settings of the template,
                  like <code class="inline-code">&lt;#ftl
                  output_format=&#39;HTML&#39;</code><code class="inline-code">
                  auto_esc=false&gt;</code>.</p>
                </li>

                <li>
                  <p>New built-in: <a href="ref_builtins_string.html#ref_builtin_no_esc"><code>no_esc</code></a>.
                  Used to prevent auto-escaping, like
                  <code class="inline-code">${descriptionInHtml?no_esc}</code>. This doesn&#39;t
                  work with <code class="inline-code">&lt;#escape
                  <em class="code-color">...</em>&gt;</code>, only with the
                  new auto-escaping mechanism.</p>
                </li>

                <li>
                  <p>New FTL type, "markup output". This is
                  somewhat similar to string, but values of this type aren&#39;t
                  auto-escaped by the new escaping mechanism, because they are
                  known to already hold markup. (For example,
                  <code class="inline-code">?esc</code> and <code class="inline-code">?no_esc</code>
                  returns a value of this type, hence their results are
                  protected from double-escaping problems.)</p>
                </li>

                <li>
                  <p>New built-in: <a href="ref_builtins_string.html#ref_builtin_esc"><code>esc</code></a>.
                  Used for escaping with the current output format when
                  auto-escaping is disabled.</p>
                </li>

                <li>
                  <p>Added new built-in: <code class="inline-code">markup_string</code>.
                  This returns the markup of a <a href="dgui_misc_autoescaping.html#dgui_misc_autoescaping_movalues">markup output
                  value</a> as a string.</p>
                </li>

                <li>
                  <p>New directive: <code class="inline-code">outputformat</code>, used
                  to change the output format for a section of a template,
                  like <code class="inline-code">&lt;#outputformat
                  &quot;XML&quot;&gt;<em class="code-color">...</em>&lt;/#outputformat&gt;</code></p>
                </li>

                <li>
                  <p>New directives: <code class="inline-code">noautoesc</code> and
                  <code class="inline-code">autoesc</code>, used to turn auto-escaping off
                  and on for a section of a template, like
                  <code class="inline-code">&lt;#noautoesc&gt;<em class="code-color">...</em>&lt;/#noautoesc&gt;</code>.</p>
                </li>

                <li>
                  <p>New built-in variable,
                  <code class="inline-code">.output_format</code>, returns the current
                  output format at the place of invocation.</p>
                </li>

                <li>
                  <p>New built-in variable, <code class="inline-code">.auto_esc</code>,
                  returns the boolean that tells if auto-escaping is active at
                  the place of invocation.</p>
                </li>

                <li>
                  <p>Block assignments, like <code class="inline-code">&lt;#assign
                  <em class="code-color">captured</em>&gt;<em class="code-color">...</em>&lt;/#assign&gt;</code>,
                  when the current <code class="inline-code">output_format</code> is some
                  kind of markup (like HTML), will store the captured output
                  not with string type, but with "markup output"
                  type. Thus
                  <code class="inline-code">${<em class="code-color">captured</em>}</code>
                  will not get unwanted escaping.</p>
                </li>

                <li>
                  <p>The <code class="inline-code">+</code> operator (concatenation)
                  works with the new "markup output" type as
                  well. Like <code class="inline-code">someMarkup + somePlainText</code>
                  will result in markup where <code class="inline-code">somePlainText</code>
                  is included properly escaped.</p>
                </li>

                <li>
                  <p>The <code class="inline-code">has_content</code> built-in now
                  supports markup output values, considering 0 length markup
                  as empty.</p>
                </li>
              </ul>
            </li>

            <li>
              <p>There can be now user defined number and
              date/time/datetime formatters, defined by the programmers when
              configuring FreeMarker, which can be referred with strings
              starting with <code class="inline-code">&quot;@&quot;</code>, like in
              <code class="inline-code">&lt;#setting number_format=&#39;@foo&#39;&gt;</code>, or
              <code class="inline-code">${n?string.@foo_params}</code>,
              <code class="inline-code">&lt;#setting number_format=&#39;@foo params&#39;&gt;</code>,
              or <code class="inline-code">${n?string.@foo}</code>,
              <code class="inline-code">${n?string.@foo_params}</code>. This means that
              <em>if</em> custom formats are allowed in the
              configuration (by <a href="pgui_config_incompatible_improvements.html#pgui_config_incompatible_improvements_how_to_set">setting
              <code>incompatible_improvements</code></a> to 2.3.24),
              an <em>initial</em> <code class="inline-code">@</code> in
              format strings is now reserved, and need to be escaped as
              <code class="inline-code">@@</code> if it has to be there literally.</p>
            </li>

            <li>
              <p>Added new special variable:
              <code class="inline-code">.incompatible_improvements</code>, which returns the
              <a href="pgui_config_incompatible_improvements.html"><code>incompatbile_improvements</code>
              setting</a> of the current FreeMarker configuration, as a
              string.</p>
            </li>
          </ul>
        
          



<h2 class="content-header header-section2" id="autoid_154">Changes on the Java side</h2>


          <ul>
            <li>
              <p><em>Attention!</em> Raised
              minimum required Java version from 1.4 to 1.5 (aka. Java
              5)</p>
            </li>

            <li>
              <p>Added new configuration setting:
              <code class="inline-code">template_configurers</code>. This allows overriding
              the settings coming from the shared
              <code class="inline-code">Configuration</code> object for individual
              templates, based on template name patterns. <a href="pgui_config_templateconfigurers.html">See more
              here...</a></p>
            </li>

            <li>
              <p>Changes related to the <a href="dgui_misc_autoescaping.html">new auto-escaping
              mechanism</a>:</p>

              <ul>
                <li>
                  <p>Added new configuration setting:
                  <code class="inline-code">recognize_standard_file_extensions</code>. When
                  <code class="inline-code">true</code>, templates whose source name ends
                  with <code class="inline-code">&quot;.ftlh&quot;</code> will get
                  <code class="inline-code">HTML</code> <code class="inline-code">output_format</code>,
                  and those whose name ends with <code class="inline-code">&quot;.ftlx&quot;</code>
                  get <code class="inline-code">XML</code> <code class="inline-code">output_format</code>,
                  in both cases with auto-escaping on. If <a href="pgui_config_incompatible_improvements.html#pgui_config_incompatible_improvements_how_to_set">the
                  <code>incompatible_improvements</code> setting</a>
                  is set to 2.3.24 (or higher) then this setting defaults to
                  <code class="inline-code">true</code>. Otherwise it&#39;s
                  <code class="inline-code">false</code>, but enabling it is highly
                  recommended.</p>
                </li>

                <li>
                  <p>Added new configuration setting:
                  <code class="inline-code">output_format</code>. This specifies the name of
                  the <a href="dgui_misc_autoescaping.html#dgui_misc_autoescaping_outputformat">output
                  format</a> (such as <code class="inline-code">HTML</code>,
                  <code class="inline-code">XML</code>, <code class="inline-code">plainText</code>, etc.)
                  that governs auto-escaping. The output format can be
                  different for different templates, using the
                  <code class="inline-code">template_configurers</code> setting (<a href="pgui_config_outputformatsautoesc.html">see here
                  how...</a>).</p>
                </li>

                <li>
                  <p>Added new configuration setting:
                  <code class="inline-code">registered_custom_output_formats</code>. With
                  this you can add new <code class="inline-code">OutputFormat</code>-s that
                  templates can refer to by name (like in <code class="inline-code">&lt;#ftl
                  output_format=&quot;foo&quot;&gt;</code>).</p>
                </li>

                <li>
                  <p>Added new configuration setting:
                  <code class="inline-code">auto_escaping_policy</code>. This decides when
                  auto-escaping should be enabled depending on the current
                  output format.</p>
                </li>
              </ul>
            </li>

            <li>
              <p>Changes related to the custom number and
              date/time/datetime formating feature:</p>

              <ul>
                <li>
                  <p>Added new classes for implementing custom formatters:
                  <code class="inline-code">freemarker.core.TemplateNumberFormat</code>,
                  <code class="inline-code">TemplateNumberFormatFactory</code>,
                  <code class="inline-code">TemplateDateFormat</code>,
                  <code class="inline-code">TemplateDateFormatFactory</code>, also the
                  exceptions these can throw. These allow implementing any
                  kind of formatting rules that are doable in Java (they
                  aren&#39;t restricted to any <code class="inline-code">java.text</code>
                  formatters). Furthermore these formatters get the
                  <code class="inline-code">TemplateModel</code> instead of a the bare
                  <code class="inline-code">java.lang.Number</code> or
                  <code class="inline-code">java.util.Date</code>, which let you use the
                  extra application-specific meta information that you may
                  pack into the <code class="inline-code">TemplateModel</code>-s, such as
                  physical unit, preferred precision, and so on.</p>
                </li>

                <li>
                  <p>Added <code class="inline-code">custom_number_formats</code> and
                  <code class="inline-code">custom_date_formats</code> settings
                  (<code class="inline-code">Configurable.setCustomNumberFormats(Map&lt;String,
                  TemplateNumberFormatFactory&gt;)</code> and
                  <code class="inline-code">Configurable.setCustomDateFormats(Map&lt;String,
                  TemplateDateFormatFactory&gt;)</code>) with which you can
                  register your own formats. <em>If you <a href="pgui_config_incompatible_improvements.html#pgui_config_incompatible_improvements_how_to_set">set
                  <code>incompatible_improvements</code></a> to
                  2.3.24, and only then</em>, these formats can be
                  referred from everywhere where you can use a string to
                  define a format (often as a pattern), with a format string
                  like <code class="inline-code">&quot;@foo&quot;</code> or <code class="inline-code">&quot;@foo
                  params&quot;</code>, where <code class="inline-code">&quot;foo&quot;</code> is the key
                  in the <code class="inline-code">Map&lt;String, ...&gt;</code> parameter
                  of the earlier shown methods, and the parameters (if any)
                  are interpreted by the
                  <code class="inline-code">Template<em class="code-color">Xxx</em>FormatFactory</code>.
                  Like, you can do <code class="inline-code">cfg.setNumberFormat(&quot;@foo
                  params&quot;)</code>, or <code class="inline-code">&lt;#setting
                  number_format=&#39;@foo params&#39;&gt;</code>, or
                  <code class="inline-code">${n?string.@foo_params}</code>. Note that an
                  <em>initial</em> <code class="inline-code">@</code> in
                  format strings is reserved for this purpose with
                  <code class="inline-code">incompatible_improvements</code> to 2.3.24, and
                  need to be escaped as <code class="inline-code">@@</code> if it has to be
                  there literally. Note that the
                  <code class="inline-code">custom_number_formats</code> and
                  <code class="inline-code">custom_date_formats</code> settings can be set
                  per-template (via the new
                  <code class="inline-code">template_configurers</code> settings) or
                  per-<code class="inline-code">Environment</code> too, thus
                  <code class="inline-code">@foo</code> can mean something different in
                  different templates.</p>
                </li>

                <li>
                  <p>Added new <code class="inline-code">Environment</code> methods
                  returning <code class="inline-code">TemplateNumberFormat</code> and
                  <code class="inline-code">TemplateDateFormat</code> objects:
                  <code class="inline-code">getTemplateNumberFormat()</code>,
                  <code class="inline-code">getTemplateNumberFormat(String
                  formatString)</code>,
                  <code class="inline-code">getTemplateNumberFormat(String formatString, Locale
                  locale)</code>.</p>
                </li>

                <li>
                  <p>The internal format object caching architecture has
                  been reworked, so that it can handle custom formats too. But
                  this reworking also fixes some bottlenecks under highly
                  concurrent load, and some (otherwise unlikely) memory
                  leaking possibilities.</p>
                </li>
              </ul>
            </li>

            <li>
              <p>Added
              <code class="inline-code">freemarker.cache.ByteArrayTemplateLoader</code>,
              which is similar to <code class="inline-code">StringTemplateLoader</code>, but
              stores the templates as <code class="inline-code">byte[]</code>-s instead of
              as <code class="inline-code">String</code>-s.</p>
            </li>

            <li>
              <p>Upgraded JavaCC (used during build to generate the FTL
              parser) from 3.2 to 6.1.2.</p>
            </li>

            <li>
              <p>Added <code class="inline-code">Configurable.getSettingNames(boolean
              camelCase)</code>, which returns the set of valid setting
              names. This can be useful for auto-completion and such.</p>
            </li>

            <li>
              <p>Fixes and improvements in the "object
              builder" syntax used for configuring FreeMarker from
              <code class="inline-code">java.util.Properties</code> (or other string-only
              sources). This is not to be confused with the template language
              syntax, which has nothing to do with the "object
              builder" syntax we are writing about here. The
              improvements are:</p>

              <ul>
                <li>
                  <p>For nested builder expressions, the top-level result
                  class restriction were applied accidentally.</p>
                </li>

                <li>
                  <p>When resolving an expression like
                  <code class="inline-code">com.example.Foo()</code>, if there&#39;s a builder
                  class (<code class="inline-code">com.example.FooBuilder</code>), the
                  non-builder class (<code class="inline-code">com.example.Foo</code>) need
                  not exist anymore. After all,
                  <code class="inline-code">FooBuilder.build()</code> instantiates from any
                  class it wants to anyway.</p>
                </li>

                <li>
                  <p><code class="inline-code">TimeZone</code> objects can be created
                  like <code class="inline-code">TimeZone(&quot;UTC&quot;)</code>, despite that
                  there&#39;s no a such constructor.</p>
                </li>

                <li>
                  <p>Added support for creating lists with <code class="inline-code">[
                  <em class="code-color">item1</em>,
                  <em class="code-color">item2</em>,
                  <em class="code-color">...</em>
                  <em class="code-color">itemN</em> ]</code> syntax.</p>
                </li>

                <li>
                  <p>Added support for creating maps with <code class="inline-code">{
                  <em class="code-color">key1</em>:
                  <em class="code-color">value1</em>,
                  <em class="code-color">key2</em>:
                  <em class="code-color">value2</em>,
                  <em class="code-color">...</em>
                  <em class="code-color">keyN</em>:
                  <em class="code-color">valueN</em> }</code> syntax.</p>
                </li>

                <li>
                  <p>Number without decimal point will now be parsed to
                  <code class="inline-code">Integer</code>, <code class="inline-code">Long</code>, or
                  <code class="inline-code">BigInteger</code>, depending in the size of the
                  number. Earlier all number were
                  <code class="inline-code">BigDecimal</code>-s, but it had little
                  importance as number types are converted to the constructor
                  parameter type anyway.</p>
                </li>
              </ul>
            </li>

            <li>
              <p>Bug fixed, only with
              <code class="inline-code">incompatible_improvements</code> set to 2.3.24
              (<a href="pgui_datamodel_objectWrapper.html#topic.defaultObjectWrapperIcI">see how
              here...</a>): Expressions inside interpolations that were
              inside <em>string literal expressions</em> (not
              <code class="inline-code">${<em class="code-color">...</em>}</code>-s in
              general), like in <code class="inline-code">&lt;#assign s=&quot;Hello
              ${name}!&quot;&gt;</code>, always used
              <code class="inline-code">incompatibleImprovements</code> 0 (2.3.0 in effect).
              This means that expressions inside string literals had missed
              the <code class="inline-code">?html</code>,
              <code class="inline-code">?iso_<em class="code-color">...</em></code>,
              <code class="inline-code">?is_enumerable</code>, <code class="inline-code">?c</code>, etc.
              fixes/improvements.</p>
            </li>

            <li>
              <p>Bug fixed: The (rarely used) cause exception of
              <code class="inline-code">ParseException</code>-s wasn&#39;t set</p>
            </li>

            <li>
              <p>Bug fixed: When the
              <code class="inline-code">incomaptible_improvements</code> setting of an
              existing <code class="inline-code">Configuration</code> was changed, the
              template cache sometimes wasn&#39;t recreated, hence old templates
              could survive.</p>
            </li>

            <li>
              <p>Internal code cleanup: Mostly source code formatting, also
              many parser construction/setup cleanup</p>
            </li>

            <li>
              <p>JSP TLD loading now quotes the location of
              <code class="inline-code">jar</code>-s (and other <code class="inline-code">zip</code>-s)
              which can&#39;t be loaded due to zip format errors in the error
              message.</p>
            </li>
          </ul>
        <div class="bottom-pagers-wrapper"><div class="pagers bottom"><a class="paging-arrow previous" href="app_versions.html"><span>Previous</span></a><a class="paging-arrow next" href="versions_2_3_23.html"><span>Next</span></a></div></div></div></div>      </div>
    </div>
<div class="site-footer"><div class="site-width"><div class="footer-top"><div class="col-left sitemap"><div class="column"><h3 class="column-header">Overview</h3><ul><li><a href="http://freemarker.org/index.html">What is FreeMarker?</a></li><li><a href="http://freemarker.org/freemarkerdownload.html">Download</a></li><li><a href="app_versions.html">Version history</a></li><li><a href="http://freemarker.org/history.html">About us</a></li><li><a itemprop="license" href="app_license.html">License</a></li></ul></div><div class="column"><h3 class="column-header">Handy stuff</h3><ul><li><a href="http://freemarker-online.kenshoo.com/">Try template online</a></li><li><a href="dgui_template_exp.html#exp_cheatsheet">Expressions cheatsheet</a></li><li><a href="ref_directive_alphaidx.html">#directives</a></li><li><a href="ref_builtins_alphaidx.html">?built_ins</a></li><li><a href="ref_specvar.html">.special_vars</a></li></ul></div><div class="column"><h3 class="column-header">Community</h3><ul><li><a href="https://github.com/freemarker/freemarker">FreeMarker on Github</a></li><li><a href="https://twitter.com/freemarker">Follow us on Twitter</a></li><li><a href="https://sourceforge.net/p/freemarker/bugs/new/">Report a bug</a></li><li><a href="http://stackoverflow.com/questions/ask?tags=freemarker">Ask a question</a></li><li><a href="http://freemarker.org/mailing-lists.html">Mailing lists</a></li></ul></div></div><div class="col-right"><ul class="social-icons"><li><a class="github" href="https://github.com/freemarker/freemarker">Github</a></li><li><a class="twitter" href="https://twitter.com/freemarker">Twitter</a></li><li><a class="stack-overflow" href="http://stackoverflow.com/questions/ask?tags=freemarker">Stack Overflow</a></li></ul><a class="xxe" href="http://www.xmlmind.com/xmleditor/" rel="nofollow" title="Edited with XMLMind XML Editor"><span>Edited with XMLMind XML Editor</span></a></div></div><div class="footer-bottom"><p><span class="generated-for-product">Generated for: Freemarker 2.3.24 Preview 1</span><span class="last-updated"> Last generated:
<time itemprop="dateModified" datetime="2015-09-01T23:20:24Z" title="Tuesday, September 1, 2015 11:20:24 PM GMT">2015-09-01 23:20:24 GMT</time></span></p> <p class="copyright">
© <span itemprop="copyrightYear">1999</span>–2015
<a itemtype="http://schema.org/Organization" itemprop="copyrightHolder" href="http://freemarker.org">The FreeMarker Project</a>. All rights reserved. </p>
</div></div></div></body>
</html>



